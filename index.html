<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Location Tracker</title>
  <!-- Revert to the original Leaflet version -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
  integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
  crossorigin=""></script>
  <style>
    body {
      background-color: black;
      color: white;
      font-family: Arial, sans-serif;
      margin: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      flex-direction: column;
    }

    #map {
      height: 300px;
      width: 400px;
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      var map, marker, visibilityRadius;

      // Initialize the map
      map = L.map('map').setView([0, 0], 18);

      // Use a different tile server
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Â© OpenStreetMap contributors'
      }).addTo(map);

      // Initialize the marker
      marker = L.circleMarker([0, 0], {
        radius: 10,
        color: 'blue',
        fillOpacity: 0.6,
      }).addTo(map);

      // Create a semicircle for visibility radius
      visibilityRadius = L.semiCircle([0, 0], {
        radius: 100,
        color: 'red',
        fillOpacity: 0.2,
        startAngle: 60,
        stopAngle: 300,
      }).addTo(map);

      // Watch the geolocation and update the marker and visibility radius
      if (navigator.geolocation) {
        navigator.geolocation.watchPosition(
          (position) => {
            const lat = position.coords.latitude;
            const lng = position.coords.longitude;

            // Update marker position
            marker.setLatLng([lat, lng]);

            // Update visibility radius position
            visibilityRadius.setLatLng([lat, lng]);

            // Update map view
            map.setView([lat, lng], 18);
          },
          (error) => {
            console.error('Error getting geolocation:', error);
          },
        );
      } else {
        console.error('Geolocation not supported');
      }
    });
  </script>
</body>
</html>
